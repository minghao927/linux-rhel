INTERNET协议

**1.什么叫做协议？**

大家都遵守的规则。每一层为了完成一种功能，为了实现功能，就需要大家都遵守共同的规则。

**2.OSI七层模型**

| 层次    | 作用                                       |
| ----- | ---------------------------------------- |
| 应用层   | 与其它计算机进行通讯的一个应用                          |
| 表示层   | 定义数据格式及加密                                |
| 会话层   | 定义了如何开始、控制和结束一个会话                        |
| 传输层   | 是否选择差错恢复协议还是无差错恢复协议，及在同一主机上对不同应用的数据流的输入进行复用，还包括对收到的顺序不对的数据包的重新排序功能 |
| 网络层   | 寻址和路由选择、连接的建立、保持和终止                      |
| 数据链路层 | 规定电信号的分组方式                               |
| 物理层   | 把电脑连接起来的物理手段、负责传送0和1的电信号                 |

3.TCP/IP层5层模型

应用层

传输层

网络层

数据链路层

物理层

具体分析如下：

1）物理层：把电脑连接起来的物理手段、负责传送0和1的电信号

2）数据链路层：单纯传输0和1是没有意义的，要规定电信号的解读方式，多少个电信号是一组，每一组的意义又是什么。数据链路层就是来规定电信号的分组方式

​	2.1 以太网协议：刚开始的时候，每个公司都有自己一套对于电信号的解读方式，后来出现了以太网协议，用来规范电信号的解读方式。一组电信号构成了一个数据包，叫帧，每一帧有两个部分：标头（HEAD）和数据（DATA）     

​	标头：包含数据包的一些说明项：包括发送者，接受者，数据类型等等 

​	数据：数据包的具体内容

​	2.2 mac地址    

​	Mac地址指的是网卡的地址，数据包发送地址和接收地址。

​	每块网卡出厂时候都有一个全世界独一无二的mac地址。有了mac地址就能够定位网卡和数据包的路径了

​	2.3 广播

 	发送者怎么才能知道接收者的mac地址呢？通过ARP协议（后面解释）可以做到。

​	发送者必须知道接受者的mac地址才能够准确的发送数据。以太网采用了一种广撒网的方式，发送者发送的数据包会发送给本网络的所有的计算机，然后由接收到数据包的计算机来判断自己是不是接收方。

​	但是只能局限于当前子网。

3）网络层

​	我们需要有一种方法来判断两个主机是否在同一个子网内，如果在同一个子网内，可以通过广播的方式传输数据。

​	如果不在同一个子网内，则以路由的方式传输数据。这就导致了网络层的诞生。

​	3.1 ip协议

​	规定网络地址的协议称为ip协议。

​	判断是否处于同一个子网络的方法：将不同的ip地址和子网掩码分别进行ADC运算，结果如果相同，说明在同一个子网中。

​	ip地址存储在以太网数据包的DATA部分

​	包括ip地址的HEAD和data

​	标头包括：版本，长度，IP地址等信息

​	数据则是ip数据包的具体内容。

​	3.2 ARP协议

​	现在有了ip地址，那么怎么获取mac地址呢？arp协议，就是通过ip地址获取mac地址的机制。

​	两种情况

​	1）两台计算机在同一个子网络，可以通过arp协议，获取到对方的mac地址。arp发出一个数据包，在对方的mac地址遮拦填写的是FF:FF:FF:FF:FF:FF，表示这是一个广播地址，在子网中的所有主机收到数据包后，取出其中的ip地址，和自己的ip地制作比对，如果相同，则作出回复，向对方报告自己的MAC地址，不然则丢弃对应数据包。

​	2）两台计算机不在同一个子网内，只能将数据包传给网关，由网关去处理。

4）传输层

之前已经完成了主机和主机之间的通讯，但是不能区分服务，需要通过端口号来区分不同的服务。

传输层实现的是端对端的服务，只要能确定主机和端口，就能够实现程序之间的交流。

unix系统把主机+端口称为套接字（socket）

​	4.1 UDP协议

​	udp数据包同样由HEAD和data构成

​	标头主要定义了发出端口和接收端口

​	数据部分定义了具体的内容

​	4.2 TCP协议

​	TCP协议可以认为是有确认机制的UDP协议。每发出一个数据包都要求确认，如果有一个数据包丢失，收不到确认，则发出方就知道有必要重发这个数据包了。

​	因此，TCP协议能够保证数据不会丢失，缺点是过程复杂，资源小好多。

​	TCP协议的三次握手四次挥手这里略。

5）应用层 

直接和应用程序借口，并提供常见的网络应用服务。

应用层的作用：就是规定应用程序的数据格式，直接面对用户。

应用程序协议构成了应用层，比如email，www，ftp等等

5.网关

发送以太网数据需要两个地址，对方的mac地址和对方的ip地址

但是mac地址有局限性，两台电脑不在同一个网络，就无法知道mac地址，需要通过网关转发。

​                                                                                                                                                                                         